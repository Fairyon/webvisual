<link rel="import" href="../logo-element.html"/>
<link rel="import" href="../circle-element.html"/>

<dom-module id="loading-page">
  <style>
    :host {
      color: white;
    }
    :host[dark] {
      color: #A8CCDB;
    }
    section#mainContent {
      height: 100%;
      width: 100%;
      position: fixed;
      background: #669DB4;
      z-index: 8;
    }
    section#mainContent[dark] {
      background: #345475;
    }
    /*@media all and (min-width: 0px) and (max-width: 950px) , all and (orientation: portrait) {
      logo-element {
        height: 20vw !important;
        width: 62vw !important;
      }
      section#messageBox {
        width: 61vw !important;
      }
    }*/
    logo-element {
      top: calc(50% - 25vh);
      left: calc(50% - 31vw);
      position: fixed;
      align-self: center;
      height: 28vw;
      width: 62vw;
      z-index: 10;
    }
    section#messageBox {
      bottom: calc(5vh);
      left: calc(50% - 18vw);
      position: fixed;
      align-items: center;
      display: flex;
      justify-content: space-around;
      width: 38vw;
      height: 2.5em;
      font-family: Thin;
      font-size: 1em;
      padding-left: 10vw;
      z-index: 9;
    }
    circle-element {
      bottom: calc(20vh - 16px);
      left: calc(50% - 80px);
      position: fixed;
      padding-left: 10vw;
      z-index: 9;
    }
  </style>

  <template>
    <logo-element id="logo"></logo-element>
    <circle-element id="circle"></circle-element>
    <section id="messageBox">{{status.message}}</section>
    <section id="mainContent">
    </section>
  </template>

  <script>

  Polymer({
      is: 'loading-page',

      behaviors: [Polymer.NeonSharedElementAnimatableBehavior],

      properties: {
        status: {
          type: Object,
          value: function() { return {"message": "...",
                                      "time": {
                                        "lastData": 0,
                                        "lastStatus": 0,
                                        "lastMistake": 0,
                                        "lastError": 0
                                      }}; },
          notify: true
        },
        sharedElements: {
          value: function() {
            return {
              'herologo1': this.$.logo,
              'herologo2': this.$.logo.$.logo,
              'herobackground':  this.$.mainContent
            }
          }
        },
        animationConfig: {
          value: function() {
            return {
              'entry': [
                {
                  name: 'ripple-animation',
                  id: 'herobackground',
                  toPage: this
                },
                {
                  name: 'hero-animation',
                  id: 'herologo1',
                  toPage: this
                },
                {animatable: this.$.circle, type: 'loading'}
              ],
              'exit': [
                {
                  name: 'hero-animation',
                  id: 'herologo2',
                  fromPage: this
                },
                {
                  name: 'scale-down-animation',
                  node: this.$.mainContent
                }
              ]
            }
          }
        }
      },
      cancelAnimation: function() {
        this.$.logo.cancelAnimation();
        this.$.circle.cancelAnimation();
        if (this._player) {
          this._player.cancel();
          this._player = null;
        }
        this.fire('neon-animation-finish');
      }
    });
  </script>

</dom-module>

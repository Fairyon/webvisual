<link rel="import" href="behaviors/page-behavior.html">

<dom-module id="sign-page">
  <style>
    :host {
      margin: 0.5em;
    }
    paper-material {
      background: white;
      padding: 0em;
      border-radius: 2px 2px 2px 3px;
      align-self: stretch;
    }
    paper-material.dark {
      background: #a8a8a8;
    }

    post-card.outer > ::content #cardContent{
      padding: 0.5em 0em 0em 0.5em;
    }
    .inner {
      margin: 0em 0.55em 0.55em 0em;
    }
    .outer {
      margin: 0.5em;
    }

    paper-dialog#optionDialog {
      border-radius: 5px 5px 0px 0px;
      position: fixed;
      margin: 0em 0em;
      bottom: 0em;
      max-height: 38vh;
      min-width: 40vw;
      max-width: calc(100vw - 3em);
    }

  </style>
  <template>
      <section id="mainContent" class="horizontal layout start wrap">

        <template id="groupingtemplate" is="dom-repeat" items="{{selectedGroup}}" as="groupedItem" sort="sortGroup">
          <post-card class="outer shadow-elevation-4dp" headline="[[groupedItem.group]]">

            <template id="elementlist" is="dom-repeat" items="{{data}}" as="element">
              <template is="dom-if" if="[[groupElements(element,groupedItem)]]" restamp>
                <paper-material class="inner" elevation="1" class="vertical layout center">

                    <sign-element element="[[element]]" show-exceeds on-click="setSelectedElement"></sign-element>
                    <sign-caption element="[[element]]"></sign-caption>

                </paper-material>
              </template>
            </template>
          </post-card>
        </template>
      </section>

    <!-- Page-Options -->
    <paper-dialog id="optionDialog" entry-animation="slide-to-up-animation" exit-animation="slide-to-down-animation">
      <section class="horizontal layout">
        <post-card headline="Gruppieren nach">
          <paper-menu attr-for-selected="id" selected="{{groupBy}}">
            <template is="dom-repeat" items="{{keys}}" as="key">
              <paper-item id="[[key]]">[[key]]</paper-item>
            </template>
          </paper-menu>
        </post-card>
      </section>
    </paper-dialog>

  </template>

  <script>

    Polymer({
      is: 'sign-page',

      behaviors: [ScrollBehavior, DataBehavior, LanguageBehavior, PageBehavior],

      setSelectedElement: function(e) {
        if (this.selectedElement == e.currentTarget.__data__.element){
          this.set('selectedElement',{});
          e.currentTarget.style.outline = "none";
        }
        else {
          this.set('selectedElement',e.currentTarget.__data__.element);
          e.currentTarget.style.outline = "2px solid blue";
        }
      }

    });
  </script>

</dom-module>

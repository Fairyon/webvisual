<dom-module id="main-toolbar">
  <style is="costum-style">
    :host {
      display: flex;
      flex-direction: column;
      position: relative;
      overflow: hidden !important;
      font-family: Roboto;
      font-weight: normal;
      cursor: pointer;
      -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;
      -webkit-touch-callout: none;
      text-overflow: ellipsis;
      white-space: nowrap;
      -webkit-tap-highlight-color:rgba(0,0,0,0);
      margin: 0em;
      padding: 0em;
      height: 64px;
      max-height: 48vh;
    }
    :host[opened]{
      height: auto;
    }
    section#mainContent {
      display: flex;
      flex-direction: column;
      margin: 0em;
      padding: 0em;
      background: #005B82;
      color: #f1f1f1;
    }
    section#mainContent[dark] {
      background: #345475;
      color: #A8CCDB;
    }
    section#header {
      height: 44px;
      width: calc(100% - 16px);
      padding: 10px 8px;
      display: flex;
      flex-direction: row;
      align-items: center;
    }
    section#lower {
      max-height: 128px;
      overflow: hidden !important;
      padding: 0.5em;
      display: flex;
      flex-direction: row;
      align-items: stretch;
      background: linear-gradient(180deg, rgba(255, 255, 255, 0), rgba(230, 230, 230, 0.2), rgba(255, 255, 255, 0));
    }
    section#header ::content paper-icon-button {
      margin: 0px 8px;
      transition: all 0.28s cubic-bezier(0.4, 0, 0.2, 1);
    }
    section#header ::content paper-icon-button:hover {
      background: #669DB4;
      color: #f1f1f1;
      border-radius: 50%;
      box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14),
                  0 1px 5px 0 rgba(0, 0, 0, 0.12),
                  0 3px 1px -2px rgba(0, 0, 0, 0.2);
    }
    section#lower ::content .card {
      display: flex;
      flex-wrap: wrap;
      border: this solid #252D36;
    }
    section#lower ::content sign-element {
      height: auto;
    }
    section#lower ::content table-element {
      height: 7em;
    }
    section#lower ::content .caption {
      padding: 1em 0.7em;
    }
    section#selSign {
      display: flex;
      flex-direction: row;
    }
    @media all and (max-width: 400px) {
      section#lower ::content .card {
        display: flex;
        flex-direction: row;
      }
      section#lower {
        font-size: 0.9em;
        max-height: 104px;
      }
    }
    @media all and (min-width: 400px) and (max-width: 600px) {
      section#lower {
        font-size: 1em;
        max-height: 128px;
      }
    }
    @media all and (min-width: 600px) and (max-width: 1000px) {
      section#lower {
        font-size: 1.1em;
        max-height: 192px;
      }
    }
    @media all and (min-width: 1001px) and (max-width: 1400px) {
      section#lower {
        font-size: 1.15em;
        max-height: 224px;
      }
    }
    @media all and (min-width: 1401px) {
      section#lower {
        font-size: 1.2em;
        max-height: 272px;
      }
    }
    .flex {
      -ms-flex: 1;
      -webkit-flex: 1;
      flex: 1;
    }
  </style>
  <template>

    <section id="mainContent" on-track="handleTrack">
      <section id="header">
        <content select=".header"></content>
        <div class="flex"></div>
        <section hidden="{{!opened}}">
          <content select=".toggle-icon"></content>
        </section>
      </section>
      <section id="lower">
        <section id="selSign">
          <content id="sign" select="#selectedElementSign,#selectedElementCaption"></content>
        </section>
        <content id="table" select="#selectedElementTable"></content>
      </section>
    </section>

  </template>

  <script>

  Polymer({
    is: 'main-toolbar',

    hostAttributes: {
      'role': 'toolbar'
    },

    behaviors: [
      Polymer.NeonAnimationRunnerBehavior
    ],

    attached: function() {
      var nodeSign  = Polymer.dom(this.$.sign).getDistributedNodes();
      var nodeTable = Polymer.dom(this.$.table).getDistributedNodes();
      var nodes = nodeSign.concat(nodeTable);
      this.animationConfig.in[0].nodes = Array.prototype.slice.call(nodes);
      this.animationConfig.out[0].nodes = Array.prototype.slice.call(nodes);
    },

    properties: {
      opened: {
        type: Boolean,
        value: false,
        reflectToAttribute: true
      },
      animationConfig: {
        type: Object,
        value: function() {
          return {
            'in': [
              {
                name: 'cascaded-animation',
                animation: 'scale-up-animation',
                nodeDelay: 80
              }
            ],
            'out': [
              {
                name: 'cascaded-animation',
                animation: 'transform-animation',
                transformFrom: 'none',
                transformTo: 'translateX(-500%)',
                nodeDelay: 1
              }
            ]
          };
        }
      }
    },

    handleTrack: function(e) {
      if (e.target == this.$.lower && this.opened && (e.detail.state == 'end') && e.detail.dy < 0)
        this.fire('deselect');
    }

  });
  </script>
</dom-module>

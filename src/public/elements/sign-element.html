<dom-module id="sign-element">
  <style>
  :host {
    position: relative;
    color: #1d1d1d;
    border-radius: 2px;
    overlay: hidden;
    display: flex;
    z-index: 0;
    outline: none;
    font-family: 'Roboto-Condensed-Light';
    background: transparent;
    user-select: none;
    min-height: 4em;
    min-width: 4em;
    margin: 1em; //
  }

  .main {
    position: relative;
    border-radius: inherit;
    padding: 0.5em 0.3em;
    width: 100%;
    background: white;
  }
  .dateSection {
    line-height: 1.5em;
    font-size: 2em;
    font-style: normal;
    font-weight: 300;
  }
  .unitSection {
    padding-left: 0.3em;
    font-size: 0.8em;
    font-weight: 100;
  }
  .exceedsSection {
    padding-left: 0.3em;
    padding-right: 0.3em;
    font-weight: 300;
    line-height: 1em;
  }
  .exceedsDateSection {
    font-style: italic;
    font-size: 0.7em;
  }
  .exceedsValueSection {
    padding-left: 0.5em;
    font-style: normal;
    font-size: 0.8em;
  }
  #ripple {
    color: #1d1d1d;
  }
  </style>
  <template>
    <section class="main" class="vertical layout">
      <paper-ripple id="ripple" class="fill" fit initialOpaciy="0.10"></paper-ripple>
      <section class="valueSection" class="horizontal layout flex center-justified"><span class="dateSection">[[firstY(element.values.*, 'y')]]</span><span class="unitSection center">[[element.unit]]</span></section>

      <template is="dom-if" if="{{element.lastExceeds}}">
        <section class="exceedsSection" class="horizontal layout center-justified">
          <div class="exceedsDateSection">[[computeX(element.lastExceeds.x)]]</div><div class="exceedsValueSection">[[computeY(element.lastExceeds.y,element.lastExceeds.exceeds)]]</div>
        </section>
      </template>

    </section>
  </template>

  <script>

    Polymer({
      is: 'sign-element',

      properties: {
          element: {
            type: Object,
            value: function() { return {"values":[]}; }
          },
          language: {
            type: Object,
            value: function() { return {'x':'Datum','y':'Wert'}; }
          },
          timeFormat: {
            type: String,
            value: "HH:mm:ss"
          },
          selected: {
            type: Boolean,
            value: false
          },
          showExceeds: {
            type: Boolean,
            notify: true,
            reflectToAttribute: true
          }
      },

      observers: [
        ],

      firstX: function(change, path) {
        return computeX(this.get(path, change.base[0]));
      },

      firstY: function(change, path) {
        var y = this.get(path, change.base[0]);
        var exceeds = this.get('exceeds', change.base[0]);
        return this.computeY(y, exceeds);
      },

      computeX: function(date){
        if(date)
          return $.format.toBrowserTimeZone(date,this.timeFormat);
        else
          return undefined;
      },

      computeY: function(value,exceeds){
        if(!value && value !=0)
          return undefined;
        else if (this.element.isBoolean){
          if (exceeds==true || exceeds==false)
            return "✗";
          else
            return "✓";
        }
        else {
          return value;
        }
      },

      computeElevation: function(){
        if (this.selected)
          return "4";
        else {
          return "2";
        }
      },

      computeId: function(exceeds){
        return exceeds;
      },

      scrollHandler: function(e) {
      }

    });
  </script>

</dom-module>

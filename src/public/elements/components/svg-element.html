<dom-module id="svg-element">

<style>
  :host {
    border-radius: inherit;
    font-family: Fira Sans Light;
    font-weight: normal;
    -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;
    -webkit-touch-callout: none; -webkit-tap-highlight-color:rgba(0,0,0,0);

    display: block;
    min-height: 1px;
  	position: relative;

  	overflow: hidden;
  }
  div#svgcontainer {
    border-radius: inherit;
    display: block;
  }
</style>
<template>
  <div id="svgcontainer">
  </div>
</template>

<script>
  SVGElement = Polymer({
    is: 'svg-element',

    // behaviors: [Polymer.IronResizableBehavior],

    properties: {
      src: {
        type: String,
        value: ''
      },
      selected: {
        type: String,
        value: ''
      },
      zoomable: {
        type: Boolean,
        value: true,
        reflectToAttribute: true
      }
    },

    listeners: {
      'zoom': 'zoomed',
      'iron-resize': 'prepare'
    },

    attached: function() {
        this.show();
    },

    prepare: function() {
      // var bounds = this.getBoundingClientRect();
      // var svgcontainer = d3.select(this.$.svgcontainer)
      //             .attr("preserveAspectRatio", "xMinYMin meet")
      //             .attr("viewBox", "0 0 1200 800");
    },

    show: function() {
      self = this;
      var svgcontainer = d3.select(this.$.svgcontainer)
                           .call(d3.behavior.zoom().scaleExtent([1, 8]).on("zoom", zoom));

      d3.xml("/img/HNF-GDS/E0_gaskabinet.svg", "image/svg+xml",
        function(error, xml) {
          if (error) throw error;
          var svgNode = document.importNode(xml.documentElement, true);

          svgcontainer.node().appendChild(svgNode);
          d3.select(svgNode).attr("style", "display: block;")
                            .attr("preserveAspectRatio", "xMinYMin meet");
          // xml.documentElement.id = 'svgcontainer';
          // self.replaceChild(xml.documentElement, elem);
          // // var elem = this.$$('#svgcontainer');
          // var svg = d3.select(elem)
          //             .attr("preserveAspectRatio", "xMinYMin meet")
          //             .attr("viewBox", "0 0 1200 800");
          // elem.appendChild(xml.documentElement);
        });

      function zoom() {
        var innerG = svgcontainer.select("g");
        innerG.attr("transform", "translate(" + d3.event.translate + ") scale(" + d3.event.scale + ")");
      }

      d3.select("path#g4294")
        .attr('fill','#0000EE');

      // this.prepare();
    },



    zoomed: function(e) {
      if (e && this.zoomable) {
      }
    },

    resized: function(e) {
      // this.prepare();
      if (e) {
      }
    }
  });
</script>

<dom-module>

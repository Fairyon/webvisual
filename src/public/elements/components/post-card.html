<dom-module id="post-card">
    <style>
      :host {
        border-radius: 4px 5px 4px 5px;
        -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;
        -webkit-touch-callout: none; -webkit-tap-highlight-color:rgba(0,0,0,0);
        /*padding: 0.4em;*/
        font-family: Fira Sans Light;
        font-weight: normal;
        padding: 0.4em;
      }
      section#main {
        background: #f1f1f1;
        border: none;
        border-color: #AAA;
        border-radius: inherit;
        transition: box-shadow 0.28s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 0 4px 5px 0 rgba(0, 0, 0, 0.14),
                    0 1px 10px 0 rgba(0, 0, 0, 0.12),
                    0 2px 4px -1px rgba(0, 0, 0, 0.4);
      }
      section#main[dark] {
        background: #8A8A8A;
        border-color: #444;
      }
      section#main[name='all'], section#main[nowindow] {
        background: transparent;
        border-radius: inherit;
        box-shadow: none;
        border-color: transparent;
      }
      section.header {
        position: relative;
        border-top-left-radius: inherit;
        border-top-right-radius: inherit;
        overflow: hidden;
        border-bottom-left-radius: 0px;
        border-bottom-right-radius: 0px;
        background: #669DB4;
      }
      section.header[dark] {
        background: #345475;
      }
      section#title {
        width: auto;
        font-size: 1.1em;
        padding: 0.6em 0.8em;
        margin: 0em;
        color: white;
        border-top-left-radius: inherit;
        border-top-right-radius: inherit;
        border-bottom-left-radius: 0px;
        border-bottom-right-radius: 0px;
        background: linear-gradient(to bottom, rgba(255,255,255,0.01) 5%,rgba(255,255,255,0.05) 40%);
        text-transform: none;
      }
      section.header section#title.text.over-image {
        position: absolute;
        background: none !important;;
        bottom: 0px;
        color: white;
        text-shadow: 0px 0px 5px #1f1f1f;
      }
      section#title[dark] {
        color: #A8CCDB;
      }
      section#mainContent {
        flex-direction: row;
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        align-items: flex-start;
        border-width: thin;
        border-style: solid;
        border-color: inherit;
        border-top-left-radius: 0px;
        border-top-right-radius: 0px;
        border-bottom-left-radius: inherit;
        border-bottom-right-radius: inherit;
        padding: 0.5em 0em 0em 0.5em;
      }
      @media all and (min-width: 750px) and (max-width: 1280px) and (orientation: portrait) {
        section#main:not([name='all']) {
          max-width: 31.5em;
        }
      }
      @media all and (min-width: 600px) and (max-width: 1280px) and (orientation: landscape) {
        section#main:not([name='all']) {
          max-width: 31.5em;
        }
      }
      @media all and (min-width: 1280px) {
        section#main:not([name='all']) {
          max-width: 39.5em;
        }
      }

      div#map {
        max-height: 30vh;
        width: auto;
      }

    </style>
    <!-- <link rel="import" href="../style/ol.css" type="css"/> -->
  <template>
    <section id="main" name$="[[title]]" nowindow$="{{withoutWindow}}">
      <section class="header">
        <iron-collapse id="imageCollapse" opened duration="1">
          <svg-element hidden$="{{!svg}}" src="{{svg}}" zoomable></svg-element>
          <!-- <div id="map" class="map"></div> -->
          <!-- <iron-image hidden$="[[!image]]" src="[[image]]" preload$="[[preloadImage]]" fade$="[[fadeImage]]"></iron-image> -->
        </iron-collapse>
        <section id="title" hidden$="[[_hideTitle(title,withoutWindow)]]" class$="[[_computeHeadingClass(image, opened)]]" on-tap="toggleCollapse">[[title]]</section>
      </section>
      <section id="mainContent">
        <content></content>
      </section>
    </section>

  </template>
  <script>
    Polymer({
      is: 'post-card',

      properties: {
        placeholder: {
          type: String,
          value: "Diverse"
        },
        title: {
          type: String,
          value: '',
          observer: '_titleChanged'
        },
        withoutWindow: {
          type: Boolean,
          value: false,
          reflectToAttribute: true
        },
        opened: {
          type: Boolean,
          value: false
        },
        /**
         * The url of the image of the card.
         */
        image: {
          type: String,
          value: ''
        },
        /**
         * The url of the svg of the card.
         */
        svg: {
          type: String,
          value: ''
        },

        /**
         * When `true`, any change to the image url property will cause the
         * `placeholder` image to be shown until the image is fully rendered.
         */
        preloadImage: {
          type: Boolean,
          value: false
        },

        /**
         * When `preloadImage` is true, setting `fadeImage` to true will cause the
         * image to fade into place.
         */
        fadeImage: {
          type: Boolean,
          value: false
        },
      },

      attached: function() {
        //   var extent = [0, 0, 1200, 800];
        //   var projection = new ol.proj.Projection({
        //     code: 'EPSG:3857',
        //   });
        //
        //   var map = new ol.Map({
        //   controls: ol.control.defaults({
        //     attribution:  false,
        //     zoom: false,
        //     rotate: false
        //     }),
        //   layers: [
        //     new ol.layer.Tile({
        //       source: new ol.source.XYZ({
        //         url: 'https://localhost/img/maps/{z}/{x}/{y}.png',
        //         projection: projection
        //       })
        //     })
        //   ],
        //   target: this.$.map,
        //   view: new ol.View({
        //     center: ol.proj.transform(
        //       [6.41041, 50.904], 'EPSG:3857', 'EPSG:3857'),
        //     zoom: 13,
        //     minZoom: 10,
        //     maxZoom: 19
        //   })
        // });
        // map.getView().fit(extent, map.getSize());
        // var map = new ol.Map({
        //   layers: [
        //     new ol.layer.Tile({
        //       source: new ol.source.Stamen({
        //         layer: 'watercolor'
        //       })
        //     })
        //   ],
        //   target: this.$.map,
        //   view: new ol.View({
        //     center: ol.proj.transform(
        //         [6.41041, 50.904], 'EPSG:4326', 'EPSG:3857'),
        //     zoom: 15
        //   })
        // });
      },

      toggleCollapse: function() {
        this.$.imageCollapse.toggle();
      },

      _titleChanged: function(text) {
        if (!text)
          this.set('title', this.placeholder);
        // var label = this.getAttribute('aria-label');
        this.setAttribute('aria-label', this.title);
      },

      _computeHeadingClass: function(image, showMap) {
        var cls = 'text';
        if (image || showMap)
          cls += ' over-image';
        return cls;
      },

      _hideTitle: function(title,withoutWindow) {
        if(title == 'all' || withoutWindow)
          return true;
        else
          return false;
      }
    });
  </script>
</dom-module>

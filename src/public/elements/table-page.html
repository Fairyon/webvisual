<dom-module id="table-page">
  <style>
    :host {
      display: inline-block;
      margin: 1em 0.5em;
    }
    paper-material {
      background: white;
      padding: 0em;
    }
    paper-material.dark {
      background: #646464;
    }
    .outer {
      margin: 0.3em;
    }
    paper-dialog#optionDialog {
      border-radius: 5px 5px 0px 0px;
      position: fixed;
      margin: 0em 0em;
      bottom: 0em;
      left: 1.5em;
      max-height: 38vh;
      width: calc(100vw - 3em);
    }

  </style>
  <template>
      <section id="content">
        <iron-selector selected="0" class="horizontal layout wrap center-justified">
          <template is="dom-repeat" items="{{data}}" as="element" filter="" observe="room data.room">
            <paper-material id="{{element.id}}" class="outer" elevation="3" class="vertical layout center">
                <table-element element="{{element}}"></table-element>
            </paper-material>
          </template>
        </iron-selector>
    </section>

    <!-- Page-Options -->
  <paper-dialog id="optionDialog" entry-animation="slide-to-up-animation" exit-animation="slide-to-down-animation">

  </paper-dialog>

  </template>

  <script>

    Polymer({
      is: 'table-page',

      properties: {
          data: {
            type: Array,
            value: function() { return []; },
            notify: true
          },
          groups: {
            type: Array,
            value: function() { return []; },
            notify: true
          },
          groupSelected: {
            type: String,
            value: "",
            notify: true
          },
          isGrouping: {
            type: Boolean,
            value: false,
            notify: true
          }
      },

      // observers: [
      //     'datacheck(data.*)'
      //   ],

      listeners: {
      },

      // datacheck: function(changeRecord) {
      //   if (changeRecord.path == 'data.splices') {
      //     console.log('array mutation')
      //   } else {
      //     console.log('non array mutation '+changeRecord.path+' '+changeRecord.value+' '+changeRecord.base)
      //   }
      // },

      ready: function(){
      },

      atGroup: function(item){
        return item.room == 'Gaslager';
      },

      sort: function(next,first){
        if (first > next)
        return -1;
        else return 1;
      },

      openOption: function(){
        this.$.optionDialog.open();
      },

      insertTable: function() {
        // var time = new Date();
        // var section = this.$.table;
        // for (var i=0; i < this.data.length; i++) {
        //   var table = document.createElement("table");
        //   for (var j=0; j < 2; j++) {
        //     var row = document.createElement("tr");
        //
        //     var td = document.createElement("td")
        //     td.innerHTML = this.data[i].room;
        //     row.appendChild(td);
        //
        //     var td = document.createElement("td")
        //     td.innerHTML = this.data[i].kind;
        //     row.appendChild(td);
        //
        //     var td = document.createElement("td")
        //     td.innerHTML = this.data[i].method;
        //     row.appendChild(td);
        //
        //     var td = document.createElement("td")
        //     var x = 2*i + j;
        //     td.innerHTML = x;
        //     row.appendChild(td);
        //
        //     table.appendChild(row);
        //   }
        //   section.appendChild(table);
        // }

        //   var tmp = [];
        //   for (i=0; i<this.data.length; i++) {
        //     for (j=0; j<this.data[i].data.length; j++) {
        //       tmp.push({"id":    this.data[i].id,
        //                 "room":  this.data[i].room,
        //                 "kind":  this.data[i].kind,
        //                 "method" :  this.data[i].method,
        //                 "unit":  this.data[i].unit,
        //                 "date":  this.data[i].data[j].date,
        //                 "value": this.data[i].data[j].value,
        //                 "exceeds": this.data[i].data[j].exceeds,
        //                 "color":  this.data[i].data[j].color});
        //     }
        //   }
        //   this.reduced = tmp;
        //
        // var timeafter = new Date();
        // time = timeafter - time;
        // console.log(time);
      },

      scrollHandler: function() {
        // var time = new Date();
        // var section = this.$.table;
        // for (var i=0; i < this.data.length; i++) {
        //   var table = document.createElement("table");
        //   for (var j=0; j < 1; j++) {
        //     var row = document.createElement("tr");
        //
        //     var td = document.createElement("td")
        //     td.innerHTML = this.data[i].room;
        //     row.appendChild(td);
        //
        //     var td = document.createElement("td")
        //     td.innerHTML = this.data[i].kind;
        //     row.appendChild(td);
        //
        //     var td = document.createElement("td")
        //     td.innerHTML = this.data[i].method;
        //     row.appendChild(td);
        //
        //     var td = document.createElement("td")
        //     var x = i + j;
        //     td.innerHTML = x;
        //     row.appendChild(td);
        //
        //     table.appendChild(row);
        //   }
        //   section.appendChild(table);
        // }
        // var timeafter = new Date();
        // time = timeafter - time;
        // console.log(time);
      }

    });
  </script>

</dom-module>

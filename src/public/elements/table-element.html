<dom-module id="table-element">
  <style>
    :host {
      display: inline-block;
      max-height: 30vh;
      overflow-x: hidden;
      overflow-y: scroll;
    }
    table {
      text-align: center;
      border-collapse: collapse;
      table-layout: fixed;
    }
    caption {
      font-family: Roboto-Condensed-Light-Italic;
      font-size: 0.9em;
      font-style:
    }
    td {
      font-family: Roboto-Condensed;
    }
    td, th {
      font-size: 0.9em;
    }
    th {
      padding: 0.5em 1em;
    }
    td, caption {
      padding: 0.5em;
    }
    thead {
      border-top: thin solid #8c8c8c;
      border-bottom: thin solid #8c8c8c;
    }
    iron-icon {
      color: currentColor;
    }
    tr#false {
      background: #c019da;
      color: #f1f1f1;
    }
    tr#true {
      background: #e71506;
      color: #f1f1f1;
    }
  </style>
  <template>
    <table id="content">
      <caption>
        <span>{{element.roomNr}}</span><span>, </span>
        <span>{{element.room}}</span><span>, </span>
        <span>{{element.kind}}</span><span>, </span>
        <span>{{element.method}}</span>
      </caption>
      <thead>
        <th>{{language.x}}</th>
        <th>{{language.y}}</th>
      </thead>
      <tbody>
        <template is="dom-repeat" id="values" items="{{arrayItems}}">
          <tr>
            <td>{{arrayItem(element.values.*, item, 'x')}}</td>
            <td>{{arrayItem(element.values.*, item, 'y')}}</td>
          </tr>
        </template>
      <tbody>
    </table>
  </template>

  <script>

    Polymer({
      is: 'table-element',

      properties: {
          element: {
            type: Object,
            value: function() { return {}; }
          },
          language: {
            type: Object,
            value: function() { return {'x':'Datum','y':'Wert'}; }
          },
          timeFormat: {
            type: String,
            value: "HH:mm:ss"
          },
          arrayItems:{
            type: Array,
            value: function() { return [0,1,2,3,4,5]; }
          }
      },

      listeners: {
        'scroll': 'scrollHandler'
      },

      arrayItem: function(change, index, path) {
        return this.get(path, change.base[index]);
      },

      computeY: function(exceeds, value){
        if (this.element.isBoolean){
          if (exceeds==true || exceeds==false)
            return "✗";
          else
            return "✓";
        }
        else {
          return value + ' ' + this.element.unit;
        }
      },

      computeId: function(exceeds){
        if (exceeds==false)
          return "false";
        else if (exceeds==true)
          return "true";
        else
          return "done";
      },

      computeX: function(date){
        return $.format.toBrowserTimeZone(date,this.timeFormat);
      },

      scrollHandler: function(e) {
        console.log(e);
      }

    });
  </script>

</dom-module>

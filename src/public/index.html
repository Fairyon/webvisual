<!DOCTYPE html>
<head>
  <title>Webvisual</title>
  <meta name="viewport" charset="utf-8" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.8"/>
  <script src="components/webcomponentsjs/webcomponents-lite.js"></script>
  <link rel="import" href="components/polymer/polymer.html"/>
</head>
<style>
  body {
    height: 100%;
    width: 100%;
    background: #BBBBBB;
  }
  body[dark] {
    background: #666666;
  }
  section.circles {
    z-index: 0;
    position: fixed;
    top: calc(50% - 100px);
    left: 50%;
    display: flex;
    flex-direction: row;
    justify-content: center;
  }
  section.outer {
    height: 16px;
    width: 16px;
    animation-name: outer-animation;
    animation-duration: 2.5s;
    animation-timing-function: linear;
    animation-iteration-count: infinite;
    position: fixed;
    transform-origin: 0% 100px;
  }
  section.outer svg {
    animation-name: inner-animation;
    animation-duration: 2.5s;
    animation-timing-function: linear;
    animation-iteration-count: infinite;
    opacity: 0;
  }
  section.l1, svg#l1 { animation-delay: 0.0s }
  section.l2, svg#l2 { animation-delay: 0.5s }
  section.l3, svg#l3 { animation-delay: 1.0s }
  section.l4, svg#l4 { animation-delay: 1.5s }
  section.l5, svg#l5 { animation-delay: 2.0s }
  @keyframes inner-animation {
      0%   {opacity: 0.1;transform:rotate(0deg) scale(0.5);}
      50%  {opacity: 1;transform:rotate(180deg) scale(1);}
      100% {opacity: 0.1;transform:rotate(360deg) scale(0.5);}
  }
  @keyframes outer-animation {
      0%   {transform:rotate(0deg)}
      50%  {transform:rotate(-180deg)}
      100% {transform:rotate(-360deg)}
  }
</style>
<body>
  <section class="circles">
    <section class="outer l1">
      <svg id="l1" viewBox="0 0 48 48" width="48" height="48" fill="#E41A1A">
        <g id="g00"  transform="matrix(0.41959876,0,0,-0.41984392,0,55.269513)">
         <g id="g01" transform="scale(0.1,0.1)">
           <path id="Logo"
               d="m 503.402,705.496 c 0.157,-0.098 4.418,8.078 7.868,13.918 28.031,47.383 198.16,468.966 239.82,568.246 -56.34,18.57 -116.543,28.77 -179.125,28.77 C 256.07,1316.43 0,1060.49 0,744.762 0,692.703 7.10547,642.328 20.1484,594.41 c 35.9102,23.352 254.79,174.738 255.118,173.672 35.054,-129.023 153.136,-195.555 228.136,-62.586 z M 1009.09,1113.29 C 966.109,1011.68 821.477,670.809 782.699,594.098 706.316,455.242 584.27,325.691 418.922,318.25 224.848,309.52 122.07,383.562 66.746,476.805 162.832,296.16 353.012,173.148 571.965,173.148 c 315.91,0 571.985,255.942 571.985,571.614 0,140.48 -50.81,269.008 -134.86,368.528"/></g></g></svg>
    </section>
    <section class="outer l2">
      <svg id="l2" viewBox="0 0 48 48" width="48" height="48" fill="#E45D1A">
        <g id="g00"  transform="matrix(0.41959876,0,0,-0.41984392,0,55.269513)">
         <g id="g01" transform="scale(0.1,0.1)">
           <path id="Logo"
               d="m 503.402,705.496 c 0.157,-0.098 4.418,8.078 7.868,13.918 28.031,47.383 198.16,468.966 239.82,568.246 -56.34,18.57 -116.543,28.77 -179.125,28.77 C 256.07,1316.43 0,1060.49 0,744.762 0,692.703 7.10547,642.328 20.1484,594.41 c 35.9102,23.352 254.79,174.738 255.118,173.672 35.054,-129.023 153.136,-195.555 228.136,-62.586 z M 1009.09,1113.29 C 966.109,1011.68 821.477,670.809 782.699,594.098 706.316,455.242 584.27,325.691 418.922,318.25 224.848,309.52 122.07,383.562 66.746,476.805 162.832,296.16 353.012,173.148 571.965,173.148 c 315.91,0 571.985,255.942 571.985,571.614 0,140.48 -50.81,269.008 -134.86,368.528"/></g></g></svg>
    </section>
    <section class="outer l3">
      <svg id="l3" viewBox="0 0 48 48" width="48" height="48" fill="#E4D61A">
        <g id="g00"  transform="matrix(0.41959876,0,0,-0.41984392,0,55.269513)">
         <g id="g01" transform="scale(0.1,0.1)">
           <path id="Logo"
               d="m 503.402,705.496 c 0.157,-0.098 4.418,8.078 7.868,13.918 28.031,47.383 198.16,468.966 239.82,568.246 -56.34,18.57 -116.543,28.77 -179.125,28.77 C 256.07,1316.43 0,1060.49 0,744.762 0,692.703 7.10547,642.328 20.1484,594.41 c 35.9102,23.352 254.79,174.738 255.118,173.672 35.054,-129.023 153.136,-195.555 228.136,-62.586 z M 1009.09,1113.29 C 966.109,1011.68 821.477,670.809 782.699,594.098 706.316,455.242 584.27,325.691 418.922,318.25 224.848,309.52 122.07,383.562 66.746,476.805 162.832,296.16 353.012,173.148 571.965,173.148 c 315.91,0 571.985,255.942 571.985,571.614 0,140.48 -50.81,269.008 -134.86,368.528"/></g></g></svg>
    </section>
    <section class="outer l4">
      <svg id="l4" viewBox="0 0 48 48" width="48" height="48" fill="#67E41A">
        <g id="g00"  transform="matrix(0.41959876,0,0,-0.41984392,0,55.269513)">
         <g id="g01" transform="scale(0.1,0.1)">
           <path id="Logo"
               d="m 503.402,705.496 c 0.157,-0.098 4.418,8.078 7.868,13.918 28.031,47.383 198.16,468.966 239.82,568.246 -56.34,18.57 -116.543,28.77 -179.125,28.77 C 256.07,1316.43 0,1060.49 0,744.762 0,692.703 7.10547,642.328 20.1484,594.41 c 35.9102,23.352 254.79,174.738 255.118,173.672 35.054,-129.023 153.136,-195.555 228.136,-62.586 z M 1009.09,1113.29 C 966.109,1011.68 821.477,670.809 782.699,594.098 706.316,455.242 584.27,325.691 418.922,318.25 224.848,309.52 122.07,383.562 66.746,476.805 162.832,296.16 353.012,173.148 571.965,173.148 c 315.91,0 571.985,255.942 571.985,571.614 0,140.48 -50.81,269.008 -134.86,368.528"/></g></g></svg>
    </section>
    <section class="outer l5">
      <svg id="l5" viewBox="0 0 48 48" width="48" height="48" fill="#1AA9E4">
        <g id="g00"  transform="matrix(0.41959876,0,0,-0.41984392,0,55.269513)">
         <g id="g01" transform="scale(0.1,0.1)">
           <path id="Logo"
               d="m 503.402,705.496 c 0.157,-0.098 4.418,8.078 7.868,13.918 28.031,47.383 198.16,468.966 239.82,568.246 -56.34,18.57 -116.543,28.77 -179.125,28.77 C 256.07,1316.43 0,1060.49 0,744.762 0,692.703 7.10547,642.328 20.1484,594.41 c 35.9102,23.352 254.79,174.738 255.118,173.672 35.054,-129.023 153.136,-195.555 228.136,-62.586 z M 1009.09,1113.29 C 966.109,1011.68 821.477,670.809 782.699,594.098 706.316,455.242 584.27,325.691 418.922,318.25 224.848,309.52 122.07,383.562 66.746,476.805 162.832,296.16 353.012,173.148 571.965,173.148 c 315.91,0 571.985,255.942 571.985,571.614 0,140.48 -50.81,269.008 -134.86,368.528"/></g></g></svg>
    </section>
  </section>
  <pages-element></pages-element>
</body>
<dom-module id="pages-element">
  <script src="components/jquery/dist/jquery.min.js"></script>
    <script src="components/underscore/underscore-min.js"></script>
  <link rel="import" href="elements/data-socket-repeater.html"/>
  <link rel="import" href="components/neon-animation/neon-animation.html"/>
  <link rel="import" href="elements/juelich-icon.html"/>
  <link rel="import" href="elements/behaviors/page-behavior.html">
  <link rel="import" href="elements/behaviors/language-behavior.html">
  <link rel="import" href="elements/behaviors/element-behavior.html">
  <link rel="import" href="elements/pages/select-page.html"/>
  <link rel="import" href="elements/pages/loading-page.html"/>
  <link rel="import" href="elements/pages/main-page.html"/>
  <link href="css/index.css" type="text/css" rel="stylesheet"/>
  <style>
    :host {
      height: 100%;
      width: 100%;
      background: #BBBBBB;
    }
    :host[dark] {
      background: #666666;
    }
    #pages {
      height: 100%;
      width: 100%;
    }
  </style>
  <template>
    <data-socket-repeater id="datasocket"
      data="{{data}}" exceeding="{{exceeding}}" is-exceeding="{{isExceeding}}" available-labels="{{availableLabels}}" labels="[[labels]]" max-total-lines="[[maxLines]]" interval="[[interval]]"
      groups="{{groups}}" grouping-keys="{{groupingKeys}}" status="{{status}}" prefered-grouping-keys="{{preferedGroupingKeys}}">
    </data-socket-repeater>
    <neon-animated-pages id="pages" animate-initial-selection>
      <select-page id="selectPage" available-labels="[[availableLabels]]" labels="{{labels}}"></select-page>
      <loading-page id="loadPage" status="[[status]]"></loading-page>
      <main-page id="mainPage" data="[[data]]" exceeding="{{exceeding}}" is-exceeding="[[isExceeding]]" labels="{{labels}}" groups="[[groups]]" grouping-keys="[[groupingKeys]]" max-total-lines="{{maxLines}}" interval="{{interval}}" prefered-grouping-keys="{{preferedGroupingKeys}}" always-show-tabs></main-page>
    </neon-animated-pages>
  </template>
  <script>
    window.addEventListener('WebComponentsReady', function(e) {
      Polymer({
        is: 'pages-element',
        attached: function(){
          this.$.pages.set('selected', '0');
          this.$.selectPage.$.labelsCookie.load();
        },
        _onConfigset: function() {
          this.$.datasocket.opened = false;
          this.$.datasocket.connect();
          this.start = new Date();
          this.$.pages.set('selected', '1');
          this.$.selectPage.$.labelWindow.style.opacity = 0;
        },
        _onConfigreset: function() {
          this.$.datasocket.connect();
        },
        _onLoaded: function(e) {
          this.$.mainPage.setGroupBy();
          var self = this;
          var wait = new Date() - this.start;
          this.set("status.time.lastStatus",new Date()); this.set("status.message", "loading...");
          wait = (wait < 3000) ? 3000 - wait : 0;
          this.async(function() {
            // this is a bug in webanimations and and animations with intervall
              self.$.loadPage.cancelAnimation();
              self.$.pages.set('selected', '2');
          },wait);
        },
        _onRestart: function() {
          if (this.availableLabels.length != 1) {
            this.$.pages.set('selected', '0');
            this.$.selectPage.$.logo.style.visibility = "visible";
            this.$.selectPage.$.labelWindow.open();
          }
        },
        listeners: {
          "restart": "_onRestart",
          "loaded": "_onLoaded",
          "configset": "_onConfigset",
          "reconnect": "_onConfigreset"
        }
      });
    });
  </script>
</dom-module>

<head>
  <title>webvisual</title>
  <meta name="viewport" charset="utf-8" content="width=device-width, initial-scale=1, user-scalable=yes, minimum-scale=0.3"/>
  <script src="components/webcomponentsjs/webcomponents.min.js"></script>
  <link rel="import" href="components/polymer/polymer.html">
  <link rel="import" href="imports.html"/>
  <link rel="import" href="import-behaviours.html"/>
  <link rel="import" href="import-customs.html"/>
</head>
<dom-module id="pages-element">
  <style>
    #pages {
      height: 100%;
      width: 100%
    }
  </style>
  <template>
    <link href="../../css/page.css" type="text/css" rel="stylesheet"/>
    <data-socket-repeater id="datasocket"
      data="{{data}}" max-total-lines="{{maxLines}}" interval="{{interval}}"
      groups="{{groups}}" on-dataloaded="_onLoaded">
    </data-socket-repeater>
    <neon-animated-pages id="pages" selected="0" animate-initial-selection>
      <loading-page id="loading"></loading-page>
      <sign-page id="nothingSelected" class="element-page" data="{{data}}" groups="{{groups}}"
        selected-group="{{selectedGroup}}" on-selectevent="_onSelected"
        selected-element="{{selectedElement}}"></sign-page>
      <!-- <selected-element-sign-page id="firstSelected" class="element-page" data="{{data}}"
        groups="{{groups}}" selected-group="{{selectedGroup}}" on-deselectevent="_onDeselected"
        selected-element="{{selectedElement}}"></selected-element-sign-page> -->
    </neon-animated-pages>
  </template>
  <script>
    Polymer({
      is: 'pages-element',
      behaviors: [DataBehavior, PageBehavior],
      attached: function(){
        this.start = new Date();
      },
      _onSelected: function(event) {
        this.$.pages.selected = 2;
        this.$.firstSelected.fire('resize');
      },
      _onDeselected: function(event) {
        this.$.pages.selected = 1;
      },
      _onLoaded: function() {
        this.setSelectedGroup();
        var self = this;
        var wait = new Date() - this.start;
        wait = (wait < 3100) ? 3500 - wait : 0;
        console.log(wait);
        this.async(function() {
          // this is a bug in webanimations and and animations with intervall
          self.$.loading.$.logo.cancelAnimation();
          self.$.pages.selected = 1;
        },wait);
      }});
  </script>
</dom-module>
<style>
  body {
    margin: 0;
  }
</style>
<body>
    <pages-element></pages-element>
</body>
